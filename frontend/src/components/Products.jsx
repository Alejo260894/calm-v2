import React, {useEffect, useState} from 'react';import { fetchProducts, importProducts, exportProducts } from '../api';export default function Products(){ const [products,setProducts]=useState([]); const [q,setQ]=useState(''); const [file,setFile]=useState(null); useEffect(()=>{ fetchProducts().then(setProducts) },[]); async function doSearch(){ const data = await fetchProducts(q); setProducts(data) } async function doImport(){ if(!file) return alert('Select file'); const res = await importProducts(file); alert(JSON.stringify(res)); const data = await fetchProducts(); setProducts(data) } async function doExport(){ const res = await exportProducts(); const url = window.URL.createObjectURL(new Blob([res.data])); const a = document.createElement('a'); a.href=url; a.download='products.csv'; a.click() } return (<div className='bg-white p-4 rounded shadow'><h2 className='text-xl font-semibold mb-4'>Products</h2><div className='flex gap-2 mb-4'><input placeholder='Search SKU or name' value={q} onChange={e=>setQ(e.target.value)} className='p-2 border flex-1' /><button className='btn' onClick={doSearch}>Search</button><button className='btn' onClick={doExport}>Export CSV</button></div><div className='mb-4'><input type='file' onChange={e=>setFile(e.target.files[0])} /><button className='btn ml-2' onClick={doImport}>Import CSV</button></div><table className='w-full'><thead><tr><th className='text-left'>SKU</th><th className='text-left'>Name</th><th>Price</th><th>Stock</th><th>Min</th></tr></thead><tbody>{products.map(p=> <tr key={p.id}><td>{p.sku}</td><td>{p.name}</td><td>{p.price}</td><td>{p.stock}</td><td>{p.min_stock}</td></tr>)}</tbody></table></div>) }
